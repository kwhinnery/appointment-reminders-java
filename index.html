<!DOCTYPE html><html><head><title>Appointment Reminders</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Appointment Reminders"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Appointment Reminders</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement appointment reminders functionality with Java and Spark</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Introduction" class="chapter"><div data-title="Application Functionality" data-file="src/main/java/com/twilio/appointmentreminders/Server.java" class="step"><h2 id="application-s-functionality">Application&#39;s Functionality</h2>
<p>This is a web application capable of creating appointment reminders, and sending SMS based
notifications using the Twilio SMS API.</p>
<p>Within the application you can create, delete and see a list of all the appointment reminders
created in the database. To create a new appointment, you must provide an appointment&#39;s name,
a phone number where the reminder will be sent, a date for the new appointment, the amount of
minutes prior to the appointment&#39;s date when you want to get the notification and finally, the
timezone for the new appointment.</p>
<p>Head to the app&#39;s <a href="https://github.com/TwilioDevEd/appointment-reminders-java/blob/master/readme.md">readme
file</a>
to learn how to run the application in your own computer.</p>
</div><div data-title="App Dependencies" data-file="pom.xml" data-highlight="66-118" class="step"><h2 id="maven">Maven</h2>
<p>The application uses Maven as a build automation and dependency management tool. All the
dependencies for the project are declared in the pom.xml file, and they can all be installed
by running <code>mvn clean install</code>.</p>
<h3 id="the-application-has-the-following-dependencies-">The application has the following dependencies:</h3>
<ul>
<li><a href="https://www.twilio.com/docs/java/install">The Twilio Java Helper Library</a> is what this
example application is showing you how to use. It includes all the methods necessary to
communicate with Twilio&#39;s API.</li>
<li><a href="http://sparkjava.com/">Spark micro framework</a> used to serve the application using the Jetty
Server internally.</li>
<li><a href="http://www.eclipse.org/eclipselink/">EclipseLink</a> is the implementation of JPA that the
application uses</li>
<li>PostgreSQL JDBC Driver is used to connect to the DB, but this can be replaced with any DB
engine, making the appropriate changes in the code.</li>
<li>The application uses Spark&#39;s implementation of the Mustache templating engine, but you can
chose the one you want from a list of
<a href="http://sparkjava.com/documentation.html#views-templates">Spark&#39;s compatible engines</a>.</li>
<li>The application uses <a href="http://junit.org/">JUnit</a> as the testing library.</li>
<li><a href="http://www.joda.org/joda-time/">Joda-Time</a> is used to handle dates and timezones in the
application.</li>
<li><a href="http://quartz-scheduler.org/">Quartz Job Scheduler</a> is responsible for scheduling the
jobs that will send the appointment reminders through SMS using Twilio&#39;s API.</li>
<li><a href="http://flywaydb.org/">Flyway</a> handles Database migrations in the application.</li>
</ul>
</div></div><div data-title="Application Structure" class="chapter"><div data-title="Appointment Entity" data-file="src/main/java/com/twilio/appointmentreminders/models/Appointment.java" class="step"><h2 id="appointment-entity">Appointment Entity</h2>
<p>The application saves appointments to the DB using EclipseLink&#39;s implementation of JPA. The
fields required to create a new appointment are:</p>
<ol>
<li><code>name</code> String</li>
<li><code>phoneNumber</code> String</li>
<li><code>delta</code> int</li>
<li><code>date</code> String</li>
<li><code>timezone</code> String</li>
</ol>
<p>The <code>id</code> field is auto generated when an entity is persisted to the DB.
The date is always stored in the DB as UTC, but the getter of the date field makes the
conversion to the time zone provided when creating a new appointment.</p>
</div><div data-title="Appointment Service" data-file="src/main/java/com/twilio/appointmentreminders/models/AppointmentService.java" class="step"><h2 id="appointment-dao">Appointment DAO</h2>
<p>This class performs all the read write operations with appointment objects. The entity
manager is injected to this class, so it needs to be created in the context using this class.</p>
</div><div data-title="App Setup" data-file="src/main/java/com/twilio/appointmentreminders/util/AppSetup.java" class="step"><h2 id="app-setup">App Setup</h2>
<p>This is a helper class that reads all the environment variables required by the application
to work properly.</p>
<p>For DB access you just need to set the environment variable</p>
<pre><code>DATABASE_URL=
postgres://username:password@localhost:5432/appointments
</code></pre><p>in that format.
Just remember that this class will convert that URL into a set of JDBC compatible parameters.
The reason for this, is that in order to automatically deploy to Heroku, the application
must receive the DB URL in that format.</p>
<p>This class also makes available to the application the environment variables related to
authorization in the Twilio API.</p>
</div><div data-title="Server Main Class" data-file="src/main/java/com/twilio/appointmentreminders/Server.java" class="step"><h2 id="server-class">Server Class</h2>
<p>This is the main class of the application. Here you set up all the routes for the spark
application, and with the help of AppSetup class, the port in which the application runs.</p>
<p>This is the place where the <code>AppointmentService</code> containing the <code>EntityManager</code> is
instantiated, and injected to the Appointment controller.</p>
<p>The Quartz Scheduler is also instantiated here, and besides being injected to the controller
in order to schedule the reminders, we need to start an instance that will be running in the
background. Quartz is using basic configuration and storing jobs in RAM, but this can be
changed to fit your needs in
<a href="https://github.com/TwilioDevEd/appointment-reminders-java/blob/
master/src/main/resources/META-INF/quartz.properties">quartz.properties file</a>. You can check Quartz documentation
<a href="http://quartz-scheduler.org/documentation">here</a></p>
<p>All the routes are defined using Spark&#39;s <code>get</code> or <code>post</code> method accordingly. All the
parameters these two methods need are a String with the URL path, a method that will return a
route and in this case, an instance of <code>MustacheTemplateEngine</code>. The third parameter is only
necessary when a template will be rendered in the response. But, like in the <code>/delete</code> route,
if nothing is going to be rendered, you can only specify the controller method. Just remember
to check the return types of the methods in the controller, as they return different route
objects depending on the existence of a templating engine.</p>
</div><div date-title="Appointment Controller" data-file="src/main/java/com/twilio/appointmentreminders/controllers/AppointmentController.java" class="step"><h2 id="appointment-controller">Appointment Controller</h2>
<p>The <code>AppointmentController</code> controller class holds all the methods that respond to a route
declaration on the previous step. Here is where all the template rendering, database access and
job scheduling is done.</p>
<h3 id="scheduling-a-job">Scheduling a Job</h3>
<p>The <code>scheduleJob</code> method on the controller uses the Quartz scheduler that was previously
injected to the class, to set up a job ahead of the current time. The job is scheduled using the
information that the new <code>Appointment</code> entity holds. The actual SMS sending task is delegated to
<code>AppointmentScheduler</code> and it&#39;s shown in the next step.</p>
</div><div date-title="Appointment Scheduler" data-file="src/main/java/com/twilio/appointmentreminders/util/AppointmentScheduler.java" class="step"><h2 id="appointment-job">Appointment Job</h2>
<p>Every time a a scheduled job is triggered by Quartz, a new instance of this class is created.
Here is where the application will fetch the stored appointment from the DB, based on the id
that was set when scheduling the job. Once we have the appointment information we get the Twilio
API credentials from the <code>AppSetup</code> class and finally use Twilio&#39;s SDK to actually send the SMS.
In fact, sending the message requires a single line of code!</p>
<h2 id="all-done">All Done</h2>
<p>And with a little code and a dash of configuration, we&#39;re ready to get automated
appointment reminders firing in our application. Good work!</p>
<p>As always, we&#39;d love to hear your feedback on this tutorial. <a href="mailto:help@twilio.com">Please reach out to
us</a> with any questions you might have.  Thanks for
checking out the tutorial!</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/Server.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzOwoKaW1wb3J0IGNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMuY29udHJvbGxlcnMuQXBwb2ludG1lbnRDb250cm9sbGVyOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnRTZXJ2aWNlOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkFwcFNldHVwOwppbXBvcnQgb3JnLnF1YXJ0ei5TY2hlZHVsZXI7CmltcG9ydCBvcmcucXVhcnR6LlNjaGVkdWxlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5xdWFydHouaW1wbC5TdGRTY2hlZHVsZXJGYWN0b3J5OwppbXBvcnQgc3BhcmsudGVtcGxhdGUubXVzdGFjaGUuTXVzdGFjaGVUZW1wbGF0ZUVuZ2luZTsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKCmltcG9ydCBzdGF0aWMgc3BhcmsuU3BhcmsuKjsKaW1wb3J0IHNwYXJrLio7CgpwdWJsaWMgY2xhc3MgU2VydmVyIHsKCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgQXBwU2V0dXAgYXBwU2V0dXAgPSBuZXcgQXBwU2V0dXAoKTsKCiAgICAgICAgcG9ydChhcHBTZXR1cC5nZXRQb3J0TnVtYmVyKCkpOwoKICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0gYXBwU2V0dXAuZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKTsKICAgICAgICBBcHBvaW50bWVudFNlcnZpY2Ugc2VydmljZSA9IG5ldyBBcHBvaW50bWVudFNlcnZpY2UoZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCkpOwoKICAgICAgICBTcGFyay5zdGF0aWNGaWxlTG9jYXRpb24oIi9wdWJsaWMiKTsKCiAgICAgICAgU2NoZWR1bGVyIHNjaGVkdWxlciA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2NoZWR1bGVyID0gU3RkU2NoZWR1bGVyRmFjdG9yeS5nZXREZWZhdWx0U2NoZWR1bGVyKCk7CgogICAgICAgICAgICBzY2hlZHVsZXIuc3RhcnQoKTsKCiAgICAgICAgfSBjYXRjaCAoU2NoZWR1bGVyRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiVW5hYmxlIHRvIHN0YXJ0IHNjaGVkdWxlciBzZXJ2aWNlIik7CiAgICAgICAgfQoKICAgICAgICBBcHBvaW50bWVudENvbnRyb2xsZXIgY29udHJvbGxlciA9IG5ldyBBcHBvaW50bWVudENvbnRyb2xsZXIoc2VydmljZSwgc2NoZWR1bGVyKTsKCiAgICAgICAgZ2V0KCIvIiwgY29udHJvbGxlci5pbmRleCwgbmV3IE11c3RhY2hlVGVtcGxhdGVFbmdpbmUoKSk7CgogICAgICAgIGdldCgiL25ldyIsIGNvbnRyb2xsZXIucmVuZGVyQ3JlYXRlUGFnZSwgbmV3IE11c3RhY2hlVGVtcGxhdGVFbmdpbmUoKSk7CgogICAgICAgIHBvc3QoIi9jcmVhdGUiLCBjb250cm9sbGVyLmNyZWF0ZSwgbmV3IE11c3RhY2hlVGVtcGxhdGVFbmdpbmUoKSk7CgogICAgICAgIHBvc3QoIi9kZWxldGUiLCBjb250cm9sbGVyLmRlbGV0ZSk7CiAgICB9Cn0K</textarea>
<textarea class="saurus-file" data-file="pom.xml" data-mode="xml">PHByb2plY3QgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIKICAgICAgICAgeG1sbnM9Imh0dHA6Ly9tYXZlbi5hcGFjaGUub3JnL1BPTS80LjAuMCIKICAgICAgICAgeHNpOnNjaGVtYUxvY2F0aW9uPSJodHRwOi8vbWF2ZW4uYXBhY2hlLm9yZy9QT00vNC4wLjAgaHR0cDovL21hdmVuLmFwYWNoZS5vcmcveHNkL21hdmVuLTQuMC4wLnhzZCI+CgogICAgPG1vZGVsVmVyc2lvbj40LjAuMDwvbW9kZWxWZXJzaW9uPgogICAgPGdyb3VwSWQ+Y29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVyczwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPnR3aWxpby1hcHBvaW50bWVudC1yZW1pbmRlcnM8L2FydGlmYWN0SWQ+CiAgICA8dmVyc2lvbj4xLjA8L3ZlcnNpb24+CiAgICA8bmFtZT5BcHBvaW50bWVudCBSZW1pbmRlcnM8L25hbWU+CiAgICA8ZGVzY3JpcHRpb24+RGVtbyBhcHBsaWNhdGlvbiBzaG93Y2FzaW5nIHRoZSBjcmVhdGlvbiBvZiBhcHBvaW50bWVudCByZW1pbmRlcnMgdXNpbmcgdGhlIFR3aWxpbwogICAgICAgIEFQSQogICAgPC9kZXNjcmlwdGlvbj4KCiAgICA8cHJvcGVydGllcz4KICAgICAgICA8bWF2ZW4uY29tcGlsZXIuc291cmNlPjEuODwvbWF2ZW4uY29tcGlsZXIuc291cmNlPgogICAgICAgIDxtYXZlbi5jb21waWxlci50YXJnZXQ+MS44PC9tYXZlbi5jb21waWxlci50YXJnZXQ+CiAgICA8L3Byb3BlcnRpZXM+CgogICAgPGJ1aWxkPgogICAgICAgIDxwbHVnaW5zPgogICAgICAgICAgICA8cGx1Z2luPgogICAgICAgICAgICAgICAgPGdyb3VwSWQ+b3JnLmFwYWNoZS5tYXZlbi5wbHVnaW5zPC9ncm91cElkPgogICAgICAgICAgICAgICAgPGFydGlmYWN0SWQ+bWF2ZW4tamFyLXBsdWdpbjwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgICAgIDx2ZXJzaW9uPjIuMy4yPC92ZXJzaW9uPgogICAgICAgICAgICAgICAgPGNvbmZpZ3VyYXRpb24+CiAgICAgICAgICAgICAgICAgICAgPGZpbmFsTmFtZT5zZXJ2ZXI8L2ZpbmFsTmFtZT4KICAgICAgICAgICAgICAgIDwvY29uZmlndXJhdGlvbj4KICAgICAgICAgICAgPC9wbHVnaW4+CiAgICAgICAgICAgIDxwbHVnaW4+CiAgICAgICAgICAgICAgICA8Z3JvdXBJZD5vcmcuYXBhY2hlLm1hdmVuLnBsdWdpbnM8L2dyb3VwSWQ+CiAgICAgICAgICAgICAgICA8YXJ0aWZhY3RJZD5tYXZlbi1zaGFkZS1wbHVnaW48L2FydGlmYWN0SWQ+CiAgICAgICAgICAgICAgICA8dmVyc2lvbj4yLjM8L3ZlcnNpb24+CiAgICAgICAgICAgICAgICA8Y29uZmlndXJhdGlvbj4KICAgICAgICAgICAgICAgICAgICA8Y3JlYXRlRGVwZW5kZW5jeVJlZHVjZWRQb20+dHJ1ZTwvY3JlYXRlRGVwZW5kZW5jeVJlZHVjZWRQb20+CiAgICAgICAgICAgICAgICAgICAgPGZpbHRlcnM+CiAgICAgICAgICAgICAgICAgICAgICAgIDxmaWx0ZXI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YXJ0aWZhY3Q+KjoqPC9hcnRpZmFjdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxleGNsdWRlcz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZXhjbHVkZT5NRVRBLUlORi8qLlNGPC9leGNsdWRlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxleGNsdWRlPk1FVEEtSU5GLyouRFNBPC9leGNsdWRlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxleGNsdWRlPk1FVEEtSU5GLyouUlNBPC9leGNsdWRlPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9leGNsdWRlcz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9maWx0ZXI+CiAgICAgICAgICAgICAgICAgICAgPC9maWx0ZXJzPgogICAgICAgICAgICAgICAgPC9jb25maWd1cmF0aW9uPgogICAgICAgICAgICAgICAgPGV4ZWN1dGlvbnM+CiAgICAgICAgICAgICAgICAgICAgPGV4ZWN1dGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPHBoYXNlPnBhY2thZ2U8L3BoYXNlPgogICAgICAgICAgICAgICAgICAgICAgICA8Z29hbHM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Z29hbD5zaGFkZTwvZ29hbD4KICAgICAgICAgICAgICAgICAgICAgICAgPC9nb2Fscz4KICAgICAgICAgICAgICAgICAgICAgICAgPGNvbmZpZ3VyYXRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHJhbnNmb3JtZXJzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cmFuc2Zvcm1lcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wbGVtZW50YXRpb249Im9yZy5hcGFjaGUubWF2ZW4ucGx1Z2lucy5zaGFkZS5yZXNvdXJjZS5NYW5pZmVzdFJlc291cmNlVHJhbnNmb3JtZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bWFpbkNsYXNzPmNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMuU2VydmVyPC9tYWluQ2xhc3M+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cmFuc2Zvcm1lcj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHJhbnNmb3JtZXJzPgogICAgICAgICAgICAgICAgICAgICAgICA8L2NvbmZpZ3VyYXRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9leGVjdXRpb24+CiAgICAgICAgICAgICAgICA8L2V4ZWN1dGlvbnM+CiAgICAgICAgICAgIDwvcGx1Z2luPgogICAgICAgIDwvcGx1Z2lucz4KICAgIDwvYnVpbGQ+CgogICAgPGRlcGVuZGVuY2llcz4KICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgPGdyb3VwSWQ+Y29tLnNwYXJramF2YTwvZ3JvdXBJZD4KICAgICAgICAgICAgPGFydGlmYWN0SWQ+c3BhcmstY29yZTwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgPHZlcnNpb24+Mi4yPC92ZXJzaW9uPgogICAgICAgIDwvZGVwZW5kZW5jeT4KICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgPGdyb3VwSWQ+Y29tLnR3aWxpby5zZGs8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPnR3aWxpby1qYXZhLXNkazwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgPHZlcnNpb24+NC40LjE8L3ZlcnNpb24+CiAgICAgICAgPC9kZXBlbmRlbmN5PgogICAgICAgIDxkZXBlbmRlbmN5PgogICAgICAgICAgICA8Z3JvdXBJZD5vcmcuZWNsaXBzZS5wZXJzaXN0ZW5jZTwvZ3JvdXBJZD4KICAgICAgICAgICAgPGFydGlmYWN0SWQ+b3JnLmVjbGlwc2UucGVyc2lzdGVuY2UuanBhPC9hcnRpZmFjdElkPgogICAgICAgICAgICA8dmVyc2lvbj4yLjYuMDwvdmVyc2lvbj4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgIDxncm91cElkPnBvc3RncmVzcWw8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPnBvc3RncmVzcWw8L2FydGlmYWN0SWQ+CiAgICAgICAgICAgIDx2ZXJzaW9uPjkuMS05MDEtMS5qZGJjNDwvdmVyc2lvbj4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgIDxncm91cElkPmNvbS5naXRodWIuc3B1bGxhcmEubXVzdGFjaGUuamF2YTwvZ3JvdXBJZD4KICAgICAgICAgICAgPGFydGlmYWN0SWQ+Y29tcGlsZXI8L2FydGlmYWN0SWQ+CiAgICAgICAgICAgIDx2ZXJzaW9uPjAuOC4xNTwvdmVyc2lvbj4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgIDxncm91cElkPmNvbS5zcGFya2phdmE8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPnNwYXJrLXRlbXBsYXRlLW11c3RhY2hlPC9hcnRpZmFjdElkPgogICAgICAgICAgICA8dmVyc2lvbj4xLjAuMDwvdmVyc2lvbj4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgIDxncm91cElkPmp1bml0PC9ncm91cElkPgogICAgICAgICAgICA8YXJ0aWZhY3RJZD5qdW5pdDwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgPHZlcnNpb24+NC4xMjwvdmVyc2lvbj4KICAgICAgICAgICAgPHNjb3BlPnRlc3Q8L3Njb3BlPgogICAgICAgIDwvZGVwZW5kZW5jeT4KICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgPGdyb3VwSWQ+am9kYS10aW1lPC9ncm91cElkPgogICAgICAgICAgICA8YXJ0aWZhY3RJZD5qb2RhLXRpbWU8L2FydGlmYWN0SWQ+CiAgICAgICAgICAgIDx2ZXJzaW9uPjIuOC4xPC92ZXJzaW9uPgogICAgICAgIDwvZGVwZW5kZW5jeT4KICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgPGdyb3VwSWQ+b3JnLnF1YXJ0ei1zY2hlZHVsZXI8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPnF1YXJ0ejwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgPHZlcnNpb24+Mi4yLjE8L3ZlcnNpb24+CiAgICAgICAgPC9kZXBlbmRlbmN5PgogICAgICAgIDxkZXBlbmRlbmN5PgogICAgICAgICAgICA8Z3JvdXBJZD5vcmcuZmx5d2F5ZGI8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPmZseXdheS1jb3JlPC9hcnRpZmFjdElkPgogICAgICAgICAgICA8dmVyc2lvbj4zLjIuMTwvdmVyc2lvbj4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICA8L2RlcGVuZGVuY2llcz4KPC9wcm9qZWN0Pgo=</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/models/Appointment.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLm1vZGVsczsKCmltcG9ydCBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLnV0aWwuVGltZVpvbmVDb252ZXJ0ZXI7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuKjsKCkBFbnRpdHkgQFRhYmxlKG5hbWUgPSAiYXBwb2ludG1lbnRzIikgcHVibGljIGNsYXNzIEFwcG9pbnRtZW50IHsKICAgIEBJZCBAR2VuZXJhdGVkVmFsdWUoc3RyYXRlZ3kgPSBHZW5lcmF0aW9uVHlwZS5JREVOVElUWSkgQENvbHVtbihuYW1lID0gImlkIikgcHJpdmF0ZSBMb25nIGlkOwoKICAgIEBDb2x1bW4obmFtZSA9ICJuYW1lIikgcHJpdmF0ZSBTdHJpbmcgbmFtZTsKCiAgICBAQ29sdW1uKG5hbWUgPSAicGhvbmVOdW1iZXIiKSBwcml2YXRlIFN0cmluZyBwaG9uZU51bWJlcjsKCiAgICBAQ29sdW1uKG5hbWUgPSAiZGVsdGEiKSBwcml2YXRlIGludCBkZWx0YTsKCiAgICBAQ29sdW1uKG5hbWUgPSAiZGF0ZSIpIHByaXZhdGUgU3RyaW5nIGRhdGU7CgogICAgQENvbHVtbihuYW1lID0gInRpbWVab25lIikgcHJpdmF0ZSBTdHJpbmcgdGltZVpvbmU7CgogICAgcHVibGljIEFwcG9pbnRtZW50KCkgewoKICAgIH0KCiAgICBwdWJsaWMgQXBwb2ludG1lbnQoU3RyaW5nIG5hbWUsIFN0cmluZyBwaG9uZU51bWJlciwgaW50IGRlbHRhLCBTdHJpbmcgZGF0ZSwgU3RyaW5nIHRpbWVab25lKSB7CiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gcGhvbmVOdW1iZXI7CiAgICAgICAgdGhpcy5kZWx0YSA9IGRlbHRhOwogICAgICAgIHRoaXMuZGF0ZSA9IGRhdGU7CiAgICAgICAgdGhpcy50aW1lWm9uZSA9IHRpbWVab25lOwogICAgfQoKICAgIHB1YmxpYyBMb25nIGdldElkKCkgewogICAgICAgIHJldHVybiBpZDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldFBob25lTnVtYmVyKCkgewogICAgICAgIHJldHVybiB0aGlzLnBob25lTnVtYmVyOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBob25lTnVtYmVyKFN0cmluZyBwaG9uZU51bWJlcikgewogICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSBwaG9uZU51bWJlcjsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldERlbHRhKCkgewogICAgICAgIHJldHVybiB0aGlzLmRlbHRhOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERlbHRhKGludCBkZWx0YSkgewogICAgICAgIHRoaXMuZGVsdGEgPSBkZWx0YTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldERhdGUoKSB7CiAgICAgICAgcmV0dXJuIFRpbWVab25lQ29udmVydGVyLmdldERhdGVGcm9tVVRDKHRoaXMuZGF0ZSwgdGhpcy50aW1lWm9uZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGF0ZShTdHJpbmcgZGF0ZSkgewogICAgICAgIHRoaXMuZGF0ZSA9IGRhdGU7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRUaW1lWm9uZSgpIHsKICAgICAgICByZXR1cm4gdGltZVpvbmU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VGltZVpvbmUoU3RyaW5nIHRpbWVab25lKSB7CiAgICAgICAgdGhpcy50aW1lWm9uZSA9IHRpbWVab25lOwogICAgfQp9Cg==</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/models/AppointmentService.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLm1vZGVsczsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKcHVibGljIGNsYXNzIEFwcG9pbnRtZW50U2VydmljZSB7CgogICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVudGl0eU1hbmFnZXI7CgogICAgcHVibGljIEFwcG9pbnRtZW50U2VydmljZShFbnRpdHlNYW5hZ2VyIGVudGl0eU1hbmFnZXIpIHsKICAgICAgICB0aGlzLmVudGl0eU1hbmFnZXIgPSBlbnRpdHlNYW5hZ2VyOwogICAgfQoKICAgIHB1YmxpYyBBcHBvaW50bWVudCBnZXRBcHBvaW50bWVudChMb25nIGlkKSB7CiAgICAgICAgcmV0dXJuIGVudGl0eU1hbmFnZXIuZmluZChBcHBvaW50bWVudC5jbGFzcywgaWQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZShBcHBvaW50bWVudCBhcHBvaW50bWVudCkgewogICAgICAgIGdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbnRpdHlNYW5hZ2VyLnBlcnNpc3QoYXBwb2ludG1lbnQpOwogICAgICAgIGdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZGVsZXRlKEFwcG9pbnRtZW50IGFwcG9pbnRtZW50KSB7CiAgICAgICAgZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVudGl0eU1hbmFnZXIucmVtb3ZlKGFwcG9pbnRtZW50KTsKICAgICAgICBnZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PEFwcG9pbnRtZW50PiBmaW5kQWxsKCkgewogICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW50aXR5TWFuYWdlci5jcmVhdGVRdWVyeSgiU0VMRUNUIGEgRlJPTSBBcHBvaW50bWVudCBhIik7CiAgICAgICAgcmV0dXJuIHF1ZXJ5LmdldFJlc3VsdExpc3QoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkZWxldGVBbGwoKSB7CiAgICAgICAgZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW50aXR5TWFuYWdlci5jcmVhdGVRdWVyeSgiREVMRVRFIEZST00gQXBwb2ludG1lbnQiKTsKICAgICAgICBxdWVyeS5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAgZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgIH0KCiAgICBwdWJsaWMgTG9uZyBjb3VudCgpIHsKICAgICAgICBRdWVyeSBxdWVyeSA9IGVudGl0eU1hbmFnZXIuY3JlYXRlUXVlcnkoIlNFTEVDVCBDT1VOVChhKSBGUk9NIEFwcG9pbnRtZW50IGEiKTsKICAgICAgICByZXR1cm4gKExvbmcpIHF1ZXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgfQoKICAgIHByaXZhdGUgRW50aXR5VHJhbnNhY3Rpb24gZ2V0VHJhbnNhY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIGVudGl0eU1hbmFnZXIuZ2V0VHJhbnNhY3Rpb24oKTsKICAgIH0KCn0K</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/util/AppSetup.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLnV0aWw7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTsKaW1wb3J0IGphdmEubmV0LlVSSTsKaW1wb3J0IGphdmEubmV0LlVSSVN5bnRheEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCnB1YmxpYyBjbGFzcyBBcHBTZXR1cCB7CiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIFN0cmluZz4gZW52OwoKICAgIHB1YmxpYyBBcHBTZXR1cCgpIHsKICAgICAgICB0aGlzLmVudiA9IFN5c3RlbS5nZXRlbnYoKTsKICAgIH0KCiAgICBwdWJsaWMgTWFwPFN0cmluZywgU3RyaW5nPiBnZXRQYXJhbXNGcm9tREJVUkwoU3RyaW5nIHVybCkgewogICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcGFyYW1zID0gbmV3IEhhc2hNYXA8PigpOwogICAgICAgIFVSSSBkYlVyaSA9IG51bGw7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRiVXJpID0gbmV3IFVSSSh1cmwpOwogICAgICAgIH0gY2F0Y2ggKFVSSVN5bnRheEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiVW5hYmxlIHRvIHBhcnNlIERCIFVSTCIpOwogICAgICAgIH0KICAgICAgICBTdHJpbmdbXSB1c2VySW5mbyA9IGRiVXJpLmdldFVzZXJJbmZvKCkuc3BsaXQoIjoiKTsKICAgICAgICBTdHJpbmcgdXNlcm5hbWUgPSBkYlVyaS5nZXRVc2VySW5mbygpLnNwbGl0KCI6IilbMF07CiAgICAgICAgU3RyaW5nIHBhc3N3b3JkID0gbnVsbDsKICAgICAgICBpZiAodXNlckluZm8ubGVuZ3RoID4gMSkgewogICAgICAgICAgICBwYXNzd29yZCA9IGRiVXJpLmdldFVzZXJJbmZvKCkuc3BsaXQoIjoiKVsxXTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHBhc3N3b3JkID0gIiI7CiAgICAgICAgfQoKICAgICAgICBTdHJpbmcgZGJVcmwgPQogICAgICAgICAgICAiamRiYzpwb3N0Z3Jlc3FsOi8vIiArIGRiVXJpLmdldEhvc3QoKSArICc6JyArIGRiVXJpLmdldFBvcnQoKSArIGRiVXJpLmdldFBhdGgoKTsKCiAgICAgICAgcGFyYW1zLnB1dCgidXJsIiwgZGJVcmwpOwogICAgICAgIHBhcmFtcy5wdXQoInVzZXJuYW1lIiwgdXNlcm5hbWUpOwogICAgICAgIHBhcmFtcy5wdXQoInBhc3N3b3JkIiwgcGFzc3dvcmQpOwoKICAgICAgICByZXR1cm4gcGFyYW1zOwogICAgfQoKICAgIHB1YmxpYyBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBnZXRFbnRpdHlNYW5hZ2VyRmFjdG9yeSgpIHsKICAgICAgICBBcHBTZXR1cCBhcHBTZXR1cCA9IG5ldyBBcHBTZXR1cCgpOwogICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gY29uZmlnT3ZlcnJpZGVzID0gbmV3IEhhc2hNYXA8PigpOwoKICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHBhcmFtcyA9IGFwcFNldHVwLmdldFBhcmFtc0Zyb21EQlVSTChnZXREYXRhYmFzZVVSTCgpKTsKCiAgICAgICAgY29uZmlnT3ZlcnJpZGVzLnB1dCgiamF2YXgucGVyc2lzdGVuY2UuamRiYy51cmwiLCBwYXJhbXMuZ2V0KCJ1cmwiKSk7CiAgICAgICAgY29uZmlnT3ZlcnJpZGVzLnB1dCgiamF2YXgucGVyc2lzdGVuY2UuamRiYy51c2VyIiwgcGFyYW1zLmdldCgidXNlcm5hbWUiKSk7CiAgICAgICAgY29uZmlnT3ZlcnJpZGVzLnB1dCgiamF2YXgucGVyc2lzdGVuY2UuamRiYy5wYXNzd29yZCIsIHBhcmFtcy5nZXQoInBhc3N3b3JkIikpOwoKICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoIkFwcG9pbnRtZW50cy1QZXJzaXN0ZW5jZSIsIGNvbmZpZ092ZXJyaWRlcyk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRQb3J0TnVtYmVyKCkgewogICAgICAgIFN0cmluZyBwb3J0ID0gZW52LmdldCgiUE9SVCIpOwoKICAgICAgICBpZiAocG9ydCAhPSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBJbnRlZ2VyLnBhcnNlSW50KHBvcnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiA0NTY3OwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldERhdGFiYXNlVVJMKCkgewogICAgICAgIHJldHVybiBlbnYuZ2V0KCJEQVRBQkFTRV9VUkwiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldEFjY291bnRTaWQoKSB7CiAgICAgICAgcmV0dXJuIGVudi5nZXQoIlRXSUxJT19BQ0NPVU5UX1NJRCIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QXV0aFRva2VuKCkgewogICAgICAgIHJldHVybiBlbnYuZ2V0KCJUV0lMSU9fQVVUSF9UT0tFTiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0VHdpbGlvUGhvbmVOdW1iZXIoKSB7CiAgICAgICAgcmV0dXJuIGVudi5nZXQoIlRXSUxJT19QSE9ORV9OVU1CRVIiKTsKICAgIH0KfQo=</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/controllers/AppointmentController.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLmNvbnRyb2xsZXJzOwoKaW1wb3J0IGNvbS50d2lsaW8uYXBwb2ludG1lbnRyZW1pbmRlcnMubW9kZWxzLkFwcG9pbnRtZW50OwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnRTZXJ2aWNlOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkFwcG9pbnRtZW50U2NoZWR1bGVyOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLkZpZWxkVmFsaWRhdG9yOwppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy51dGlsLlRpbWVab25lczsKaW1wb3J0IG9yZy5qb2RhLnRpbWUuRGF0ZVRpbWU7CmltcG9ydCBvcmcuam9kYS50aW1lLkRhdGVUaW1lWm9uZTsKaW1wb3J0IG9yZy5qb2RhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0OwppbXBvcnQgb3JnLmpvZGEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7CmltcG9ydCBvcmcucXVhcnR6LkpvYkRldGFpbDsKaW1wb3J0IG9yZy5xdWFydHouU2NoZWR1bGVyOwppbXBvcnQgb3JnLnF1YXJ0ei5TY2hlZHVsZXJFeGNlcHRpb247CmltcG9ydCBvcmcucXVhcnR6LlRyaWdnZXI7CmltcG9ydCBzcGFyay5Nb2RlbEFuZFZpZXc7CmltcG9ydCBzcGFyay5Sb3V0ZTsKaW1wb3J0IHNwYXJrLlRlbXBsYXRlVmlld1JvdXRlOwoKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgc3RhdGljIG9yZy5xdWFydHouSm9iQnVpbGRlci5uZXdKb2I7CmltcG9ydCBzdGF0aWMgb3JnLnF1YXJ0ei5UcmlnZ2VyQnVpbGRlci5uZXdUcmlnZ2VyOwoKcHVibGljIGNsYXNzIEFwcG9pbnRtZW50Q29udHJvbGxlciB7CiAgICBwcml2YXRlIFNjaGVkdWxlciBzY2hlZHVsZXI7CiAgICBwcml2YXRlIEFwcG9pbnRtZW50U2VydmljZSBzZXJ2aWNlOwoKICAgIHB1YmxpYyBBcHBvaW50bWVudENvbnRyb2xsZXIoQXBwb2ludG1lbnRTZXJ2aWNlIHNlcnZpY2UsIFNjaGVkdWxlciBzY2hlZHVsZXIpIHsKICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgfQoKICAgIHB1YmxpYyBUZW1wbGF0ZVZpZXdSb3V0ZSByZW5kZXJDcmVhdGVQYWdlID0gKHJlcXVlc3QsIHJlc3BvbnNlKSAtPiB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CgogICAgICAgIG1hcC5wdXQoInpvbmVzIiwgdGltZVpvbmVzKCkpOwogICAgICAgIHJldHVybiBuZXcgTW9kZWxBbmRWaWV3KG1hcCwgIm5ldy5tdXN0YWNoZSIpOwogICAgfTsKCiAgICBwdWJsaWMgVGVtcGxhdGVWaWV3Um91dGUgaW5kZXggPSAocmVxdWVzdCwgcmVzcG9uc2UpIC0+IHsKICAgICAgICBNYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsKCiAgICAgICAgTGlzdDxBcHBvaW50bWVudD4gYXBwb2ludG1lbnRzID0gc2VydmljZS5maW5kQWxsKCk7CiAgICAgICAgbWFwLnB1dCgiYXBwb2ludG1lbnRzIiwgYXBwb2ludG1lbnRzKTsKCiAgICAgICAgcmV0dXJuIG5ldyBNb2RlbEFuZFZpZXcobWFwLCAiaW5kZXgubXVzdGFjaGUiKTsKICAgIH07CgogICAgcHVibGljIFJvdXRlIGRlbGV0ZSA9IChyZXF1ZXN0LCByZXNwb25zZSkgLT4gewogICAgICAgIFN0cmluZyBpZCA9IHJlcXVlc3QucXVlcnlQYXJhbXMoImlkIik7CiAgICAgICAgTG9uZyBpZExvbmcgPSBMb25nLnBhcnNlTG9uZyhpZCwgMTApOwoKICAgICAgICBBcHBvaW50bWVudCBhcHBvaW50bWVudCA9IHNlcnZpY2UuZ2V0QXBwb2ludG1lbnQoaWRMb25nKTsKICAgICAgICBzZXJ2aWNlLmRlbGV0ZShhcHBvaW50bWVudCk7CgogICAgICAgIHJlc3BvbnNlLnJlZGlyZWN0KCIvIik7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfTsKCiAgICBwdWJsaWMgVGVtcGxhdGVWaWV3Um91dGUgY3JlYXRlID0gKHJlcXVlc3QsIHJlc3BvbnNlKSAtPiB7CiAgICAgICAgRmllbGRWYWxpZGF0b3IgdmFsaWRhdG9yID0KICAgICAgICAgICAgbmV3IEZpZWxkVmFsaWRhdG9yKG5ldyBTdHJpbmdbXSB7Im5hbWUiLCAicGhvbmVOdW1iZXIiLCAiZGF0ZSIsICJkZWx0YSIsICJ0aW1lWm9uZSJ9KTsKCiAgICAgICAgaWYgKHZhbGlkYXRvci52YWxpZChyZXF1ZXN0KSkgewogICAgICAgICAgICAgICAgU3RyaW5nIG5hbWUgPSByZXF1ZXN0LnF1ZXJ5UGFyYW1zKCJuYW1lIik7CiAgICAgICAgICAgICAgICBTdHJpbmcgcGhvbmVOdW1iZXIgPSByZXF1ZXN0LnF1ZXJ5UGFyYW1zKCJwaG9uZU51bWJlciIpOwogICAgICAgICAgICAgICAgU3RyaW5nIGRhdGUgPSByZXF1ZXN0LnF1ZXJ5UGFyYW1zKCJkYXRlIik7CiAgICAgICAgICAgICAgICBpbnQgZGVsdGEgPSAwOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IEludGVnZXIucGFyc2VJbnQocmVxdWVzdC5xdWVyeVBhcmFtcygiZGVsdGEiKSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiSW52YWxpZCBmb3JtYXQgbnVtYmVyIGZvciBhcHBvaW50bWVudCBkZWx0YSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU3RyaW5nIHRpbWVab25lID0gcmVxdWVzdC5xdWVyeVBhcmFtcygidGltZVpvbmUiKTsKCiAgICAgICAgICAgICAgICBEYXRlVGltZVpvbmUgem9uZSA9IERhdGVUaW1lWm9uZS5mb3JJRCh0aW1lWm9uZSk7CiAgICAgICAgICAgICAgICBEYXRlVGltZVpvbmUgem9uZVVUQyA9IERhdGVUaW1lWm9uZS5VVEM7CgogICAgICAgICAgICAgICAgRGF0ZVRpbWUgZHQ7CiAgICAgICAgICAgICAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdC5mb3JQYXR0ZXJuKCJNTS1kZC15eXl5IGhoOm1tYSIpOwogICAgICAgICAgICAgICAgZm9ybWF0dGVyID0gZm9ybWF0dGVyLndpdGhab25lKHpvbmUpOwogICAgICAgICAgICAgICAgZHQgPSBmb3JtYXR0ZXIucGFyc2VEYXRlVGltZShkYXRlKTsKICAgICAgICAgICAgICAgIGZvcm1hdHRlciA9IGZvcm1hdHRlci53aXRoWm9uZSh6b25lVVRDKTsKICAgICAgICAgICAgICAgIFN0cmluZyBkYXRlVVRDID0gZHQudG9TdHJpbmcoZm9ybWF0dGVyKTsKCiAgICAgICAgICAgICAgICBBcHBvaW50bWVudCBhcHBvaW50bWVudCA9CiAgICAgICAgICAgICAgICAgICAgbmV3IEFwcG9pbnRtZW50KG5hbWUsIHBob25lTnVtYmVyLCBkZWx0YSwgZGF0ZVVUQywgdGltZVpvbmUpOwogICAgICAgICAgICAgICAgc2VydmljZS5jcmVhdGUoYXBwb2ludG1lbnQpOwoKICAgICAgICAgICAgICAgIHNjaGVkdWxlSm9iKGFwcG9pbnRtZW50KTsKCiAgICAgICAgICAgICAgICByZXNwb25zZS5yZWRpcmVjdCgiLyIpOwogICAgICAgIH0KCiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CgogICAgICAgIG1hcC5wdXQoInpvbmVzIiwgdGltZVpvbmVzKCkpOwogICAgICAgIHJldHVybiBuZXcgTW9kZWxBbmRWaWV3KG1hcCwgIm5ldy5tdXN0YWNoZSIpOwogICAgfTsKCiAgICBwcml2YXRlIHZvaWQgc2NoZWR1bGVKb2IoQXBwb2ludG1lbnQgYXBwb2ludG1lbnQpIHsKICAgICAgICBTdHJpbmcgYXBwb2ludG1lbnRJZCA9IGFwcG9pbnRtZW50LmdldElkKCkudG9TdHJpbmcoKTsKCiAgICAgICAgRGF0ZVRpbWVab25lIHpvbmUgPSBEYXRlVGltZVpvbmUuZm9ySUQoYXBwb2ludG1lbnQuZ2V0VGltZVpvbmUoKSk7CiAgICAgICAgRGF0ZVRpbWUgZHQ7CiAgICAgICAgRGF0ZVRpbWVGb3JtYXR0ZXIgZm9ybWF0dGVyID0gRGF0ZVRpbWVGb3JtYXQuZm9yUGF0dGVybigiTU0tZGQteXl5eSBoaDptbWEiKTsKICAgICAgICBmb3JtYXR0ZXIgPSBmb3JtYXR0ZXIud2l0aFpvbmUoem9uZSk7CiAgICAgICAgZHQgPSBmb3JtYXR0ZXIucGFyc2VEYXRlVGltZShhcHBvaW50bWVudC5nZXREYXRlKCkpOwogICAgICAgIERhdGUgZmluYWxEYXRlID0gZHQubWludXNNaW51dGVzKGFwcG9pbnRtZW50LmdldERlbHRhKCkpLnRvRGF0ZSgpOwoKICAgICAgICBKb2JEZXRhaWwgam9iID0KICAgICAgICAgICAgbmV3Sm9iKEFwcG9pbnRtZW50U2NoZWR1bGVyLmNsYXNzKS53aXRoSWRlbnRpdHkoIkFwcG9pbnRtZW50X0pfIiArIGFwcG9pbnRtZW50SWQpCiAgICAgICAgICAgICAgICAudXNpbmdKb2JEYXRhKCJhcHBvaW50bWVudElkIiwgYXBwb2ludG1lbnRJZCkuYnVpbGQoKTsKCiAgICAgICAgVHJpZ2dlciB0cmlnZ2VyID0KICAgICAgICAgICAgbmV3VHJpZ2dlcigpLndpdGhJZGVudGl0eSgiQXBwb2ludG1lbnRfVF8iICsgYXBwb2ludG1lbnRJZCkuc3RhcnRBdChmaW5hbERhdGUpLmJ1aWxkKCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNjaGVkdWxlci5zY2hlZHVsZUpvYihqb2IsIHRyaWdnZXIpOwogICAgICAgIH0gY2F0Y2ggKFNjaGVkdWxlckV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiVW5hYmxlIHRvIHNjaGVkdWxlIHRoZSBKb2IiKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBMaXN0PFN0cmluZz4gdGltZVpvbmVzKCkgewogICAgICAgIFRpbWVab25lcyB0eiA9IG5ldyBUaW1lWm9uZXMoKTsKCiAgICAgICAgcmV0dXJuIHR6LmdldFRpbWVab25lcygpOwogICAgfQp9Cg==</textarea>
<textarea class="saurus-file" data-file="src/main/java/com/twilio/appointmentreminders/util/AppointmentScheduler.java" data-mode="java">cGFja2FnZSBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLnV0aWw7CgppbXBvcnQgY29tLnR3aWxpby5hcHBvaW50bWVudHJlbWluZGVycy5tb2RlbHMuQXBwb2ludG1lbnQ7CmltcG9ydCBjb20udHdpbGlvLmFwcG9pbnRtZW50cmVtaW5kZXJzLm1vZGVscy5BcHBvaW50bWVudFNlcnZpY2U7CmltcG9ydCBjb20udHdpbGlvLnNkay5Ud2lsaW9SZXN0Q2xpZW50OwppbXBvcnQgY29tLnR3aWxpby5zZGsuVHdpbGlvUmVzdEV4Y2VwdGlvbjsKaW1wb3J0IGNvbS50d2lsaW8uc2RrLnJlc291cmNlLmZhY3RvcnkuTWVzc2FnZUZhY3Rvcnk7CmltcG9ydCBjb20udHdpbGlvLnNkay5yZXNvdXJjZS5pbnN0YW5jZS5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5odHRwLk5hbWVWYWx1ZVBhaXI7CmltcG9ydCBvcmcuYXBhY2hlLmh0dHAubWVzc2FnZS5CYXNpY05hbWVWYWx1ZVBhaXI7CmltcG9ydCBvcmcucXVhcnR6LkpvYjsKaW1wb3J0IG9yZy5xdWFydHouSm9iRGF0YU1hcDsKaW1wb3J0IG9yZy5xdWFydHouSm9iRXhlY3V0aW9uQ29udGV4dDsKaW1wb3J0IG9yZy5xdWFydHouSm9iRXhlY3V0aW9uRXhjZXB0aW9uOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKcHVibGljIGNsYXNzIEFwcG9pbnRtZW50U2NoZWR1bGVyIGltcGxlbWVudHMgSm9iIHsKICAgIHByaXZhdGUgc3RhdGljIEFwcFNldHVwIGFwcFNldHVwID0gbmV3IEFwcFNldHVwKCk7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNDT1VOVF9TSUQgPSBhcHBTZXR1cC5nZXRBY2NvdW50U2lkKCk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBVVRIX1RPS0VOID0gYXBwU2V0dXAuZ2V0QXV0aFRva2VuKCk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBUV0lMSU9fUEhPTkVfTlVNQkVSID0gYXBwU2V0dXAuZ2V0VHdpbGlvUGhvbmVOdW1iZXIoKTsKCiAgICBwdWJsaWMgQXBwb2ludG1lbnRTY2hlZHVsZXIoKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXhlY3V0ZShKb2JFeGVjdXRpb25Db250ZXh0IGNvbnRleHQpIHRocm93cyBKb2JFeGVjdXRpb25FeGNlcHRpb24gewogICAgICAgIEFwcFNldHVwIGFwcFNldHVwID0gbmV3IEFwcFNldHVwKCk7CgogICAgICAgIEVudGl0eU1hbmFnZXJGYWN0b3J5IGZhY3RvcnkgPSBhcHBTZXR1cC5nZXRFbnRpdHlNYW5hZ2VyRmFjdG9yeSgpOwogICAgICAgIEFwcG9pbnRtZW50U2VydmljZSBzZXJ2aWNlID0gbmV3IEFwcG9pbnRtZW50U2VydmljZShmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKSk7CgogICAgICAgIFR3aWxpb1Jlc3RDbGllbnQgY2xpZW50ID0gbmV3IFR3aWxpb1Jlc3RDbGllbnQoQUNDT1VOVF9TSUQsIEFVVEhfVE9LRU4pOwoKICAgICAgICBKb2JEYXRhTWFwIGRhdGFNYXAgPSBjb250ZXh0LmdldEpvYkRldGFpbCgpLmdldEpvYkRhdGFNYXAoKTsKCiAgICAgICAgU3RyaW5nIGFwcG9pbnRtZW50SWQgPSBkYXRhTWFwLmdldFN0cmluZygiYXBwb2ludG1lbnRJZCIpOwoKICAgICAgICBBcHBvaW50bWVudCBhcHBvaW50bWVudCA9IHNlcnZpY2UuZ2V0QXBwb2ludG1lbnQoTG9uZy5wYXJzZUxvbmcoYXBwb2ludG1lbnRJZCwgMTApKTsKICAgICAgICBpZiAoYXBwb2ludG1lbnQgIT0gbnVsbCkgewogICAgICAgICAgICBTdHJpbmcgbmFtZSA9IGFwcG9pbnRtZW50LmdldE5hbWUoKTsKICAgICAgICAgICAgU3RyaW5nIHBob25lTnVtYmVyID0gYXBwb2ludG1lbnQuZ2V0UGhvbmVOdW1iZXIoKTsKICAgICAgICAgICAgU3RyaW5nIGRhdGUgPSBhcHBvaW50bWVudC5nZXREYXRlKCk7CiAgICAgICAgICAgIFN0cmluZyB0aW1lWm9uZSA9IGFwcG9pbnRtZW50LmdldFRpbWVab25lKCk7CiAgICAgICAgICAgIFN0cmluZyBtZXNzYWdlQm9keSA9ICJSZW1lbWJlcjogIiArIG5hbWUgKyAiLCBvbiAiICsgZGF0ZSArICIgIiArIHRpbWVab25lOwoKICAgICAgICAgICAgLy8gQnVpbGQgYSBmaWx0ZXIgZm9yIHRoZSBNZXNzYWdlTGlzdAogICAgICAgICAgICBMaXN0PE5hbWVWYWx1ZVBhaXI+IHBhcmFtcyA9IG5ldyBBcnJheUxpc3Q8PigpOwogICAgICAgICAgICBwYXJhbXMuYWRkKG5ldyBCYXNpY05hbWVWYWx1ZVBhaXIoIkJvZHkiLCBtZXNzYWdlQm9keSkpOwogICAgICAgICAgICBwYXJhbXMuYWRkKG5ldyBCYXNpY05hbWVWYWx1ZVBhaXIoIlRvIiwgcGhvbmVOdW1iZXIpKTsKICAgICAgICAgICAgcGFyYW1zLmFkZChuZXcgQmFzaWNOYW1lVmFsdWVQYWlyKCJGcm9tIiwgVFdJTElPX1BIT05FX05VTUJFUikpOwoKICAgICAgICAgICAgTWVzc2FnZUZhY3RvcnkgbWVzc2FnZUZhY3RvcnkgPSBjbGllbnQuZ2V0QWNjb3VudCgpLmdldE1lc3NhZ2VGYWN0b3J5KCk7CiAgICAgICAgICAgIE1lc3NhZ2UgbWVzc2FnZSA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZUZhY3RvcnkuY3JlYXRlKHBhcmFtcyk7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4obWVzc2FnZS5nZXRTaWQoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFR3aWxpb1Jlc3RFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKAogICAgICAgICAgICAgICAgICAgICJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gc2VuZCB0aGUgbWVzc2FnZTogIiArIGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/appointment-reminders-java" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>